<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title></title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<p>Spatially explicit, seasonal changes in stock composition and abundance can be estimated using <code>fit_stockseasonr()</code>. <code>fit_stockseasonr()</code> automatically generates the necessary data and parameter structures to pass to TMB, fits, the model, and returns parameter estimates and predictions.</p>

<p>We&#39;ll generate inputs for an integrated version of the model using two built-in datasets. The first is an example of composition data, which is a subsample of available genetic stock identification data from the west coast Vancouver Island commercial Chinook salmon fishery. <code>comp_ex</code> is a long dataframe where each row includes the number of samples within a sampling event (here a given day and sampling location) that correspond to each stock aggregate. These data are non-integer because they represent the sum, among individuals, of genetic stock assignment probabilities. Each sampling event is spatially and temporally explicit because it is assigned to a specific region, month, and year.</p>

<p>The second dataset is example catch and effort data from the same fishery. <code>catch_ex</code> is a long dataframe where each row represents the observed catch (individual pieces) for a given region, month, and year. Note that both datasets have the same spatio-temporal strata, which is necessary to fit integrated models.</p>

<p>We&#39;ll assume that both stock composition and abundance are influenced by season (month) and location (region). We&#39;ll also account for interannual variation with IID random intercepts. We can examine the model inputs that are generated by <code>fit_stockseasonr()</code> without fitting the actual model by setting <code>fit = FALSE</code></p>

<pre><code class="r">dat_in &lt;- fit_stockseasonr(abund_formula = catch ~ 1 +
                             s(month_n, bs = &quot;tp&quot;, k = 3, m = 2) +
                             region +
                             (1 | year),
                           abund_dat = catch_ex,
                           comp_formula = agg ~ 1 + region +
                             s(month_n, bs = &quot;tp&quot;, k = 4, m = 2) +
                             (1 | year),
                           comp_dat = comp_ex,
                           model = &quot;integrated&quot;,
                           fit = FALSE)
</code></pre>

<p><code>fit_stockseasonr()</code> reshapes or &#39;widens&#39; the composition data, then in-fills zero observations for a given group with small values (0.00001) to ensure model convergence. It next uses the <code>mgcv</code> and <code>sdmTMB</code> packages to create model matrices including seasonal smooths and random intercepts for years. The result is a list of five elements:</p>

<ul>
<li><code>tmb_data</code> list of data inputs (observations, model matrices, new dataset for prediction, etc.) passed to the TMB model</li>
<li><code>tmb_pars</code> list of initial parameter values passed to the TMB model</li>
<li><code>tmb_map</code> &#39;mapped&#39; parameters that are not estimated</li>
<li><code>tmb_map</code> parameters that are estimated as random effects within TMB</li>
<li><code>wide_comp_dat</code> a wide version of the input composition data that includes infilled values</li>
</ul>

<p>Next we&#39;ll fit the model using <code>fit_stockseasonr()</code>, specifying the input composition data, catch data, and model type (<code>negbin</code>, <code>composition</code> or <code>integrated</code>) as above. This time we&#39;ll also include a new dataframe for which we would like to generate predictions. Note that the model may take several seconds to converge.</p>

<pre><code class="r">new_dat &lt;- expand.grid(
  month_n = seq(1, 12, by = 0.1),
  region = unique(comp_ex$region)
)

m1 &lt;- fit_stockseasonr(abund_formula = catch ~ 1 +
                             s(month_n, bs = &quot;tp&quot;, k = 3, m = 2) +
                             region +
                             (1 | year),
                           abund_dat = catch_ex,
                           comp_formula = agg ~ 1 + region +
                             s(month_n, bs = &quot;tp&quot;, k = 4, m = 2) +
                             (1 | year),
                           comp_dat = comp_ex,
                           model = &quot;integrated&quot;,
                       pred_dat = new_dat,
                           random_walk = TRUE,
                           fit = TRUE)
</code></pre>

<p>The object <code>m1</code> contains the model inputs described above, as well as a <code>TMB::sdreport()</code> object (named <code>sdr</code>), which includes parameter estimates for fixed effects.</p>

<pre><code class="r">theta &lt;- as.list(m1$sdr, &quot;Estimate&quot;)

# abundance estimates for regional effects
theta$b1_j
#&gt; [1]  8.19476069 -0.01017245
#composition fixed effect estimates
theta$B2_jk
#&gt;            [,1]       [,2]       [,3]       [,4]        [,5]       [,6]
#&gt; [1,]  2.4356276  0.8879957  0.7411992  1.3658515  1.33769655  0.3426505
#&gt; [2,] -0.5197888 -0.3716419  0.1682162 -1.0971269  0.79557902 -0.7513375
#&gt; [3,] -0.6756423 -1.4294631 -0.4154312 -1.1222731 -0.05767559 -0.3147967
#&gt; [4,]  0.7934484  0.2896169  0.4433772  0.2192606 -0.29939192 -0.2501454
#&gt; [5,] -0.6469329 -1.4777487 -0.1728590 -0.7231822 -0.58348745 -0.5168965
#&gt;            [,7]
#&gt; [1,] -0.0809810
#&gt; [2,] -0.2055944
#&gt; [3,]  1.0956856
#&gt; [4,]  1.4179068
#&gt; [5,]  0.8804047
</code></pre>

<p>The <code>summary(TMB::sdreport))</code> (named <code>ssdr</code>) includes model derived quantities, such as random effect estimates and integrated predictions (i.e. estimates of stock-specific abundance). Note that all predictions are provided in link space.</p>

<pre><code class="r">ssdr &lt;- m1$ssdr
unique(rownames(ssdr))
#&gt;  [1] &quot;b1_j&quot;               &quot;ln_phi&quot;             &quot;bs&quot;                
#&gt;  [4] &quot;ln_smooth_sigma&quot;    &quot;ln_sigma_re1&quot;       &quot;B2_jk&quot;             
#&gt;  [7] &quot;ln_sigma_re2&quot;       &quot;b_smooth&quot;           &quot;re1&quot;               
#&gt; [10] &quot;re2&quot;                &quot;pred_mu1&quot;           &quot;pred_Mu2&quot;          
#&gt; [13] &quot;logit_pred_Pi_prop&quot; &quot;log_pred_mu1_Pi&quot;

# predicted total abundance
head(ssdr[rownames(ssdr) %in% &quot;log_pred_mu1&quot;, ])
#&gt;      Estimate Std. Error
# predicted stock composition estimates
head(ssdr[rownames(ssdr) %in% &quot;logit_pred_Pi_prop&quot;, ])
#&gt;                      Estimate Std. Error
#&gt; logit_pred_Pi_prop -0.9688829  0.1623532
#&gt; logit_pred_Pi_prop -0.9425117  0.1546164
#&gt; logit_pred_Pi_prop -0.9165130  0.1474834
#&gt; logit_pred_Pi_prop -0.8908812  0.1410395
#&gt; logit_pred_Pi_prop -0.8656081  0.1353606
#&gt; logit_pred_Pi_prop -0.8406821  0.1305078
# predicted stock specific abundance
head(ssdr[rownames(ssdr) %in% &quot;log_pred_mu1_Pi&quot;, ])
#&gt;                 Estimate Std. Error
#&gt; log_pred_mu1_Pi 4.792131  0.4273834
#&gt; log_pred_mu1_Pi 4.906351  0.4151351
#&gt; log_pred_mu1_Pi 5.020153  0.4032914
#&gt; log_pred_mu1_Pi 5.133525  0.3918798
#&gt; log_pred_mu1_Pi 5.246449  0.3809274
#&gt; log_pred_mu1_Pi 5.358902  0.3704604
</code></pre>

<p>stockseasonr includes built-in plotting functions as example visualizations for predictions. For example, predictions of seasonal trends in mean stock composition can be visualized with <code>plot_stacked_comp()</code>.</p>

<pre><code class="r">plot_stacked_comp(x_var = &quot;month_n&quot;, grouping_var = &quot;agg&quot;, 
                  facet_var = &quot;region&quot;, ssdr = m1$ssdr, comp_dat = comp_ex,
                  pred_dat = new_dat)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAE3CAMAAABxSKMsAAABklBMVEUAAAAAADoAAGYAOmYAOpAAZrYZGUgZSJcZcboaGhoyiL0zMzM6AAA6ADo6AGY6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtIGRlIGUhIGXFISEhISHFISJdIcbpIl91NTU1NTW5NTY5Nbm5NbqtNjshmAABmADpmAGZmOgBmOjpmOpBmZjpmZmZmkNtmtttmtv9uTU1uTY5ujshuq+RxGUhxGXFxSEhxSHFxSJdxcXFxl5dxuv+OTU2OTY6ObquOjk2OjsiOq+SOyP+QOgCQOjqQOmaQZgCQZpCQkLaQtv+Q2/+XSEiXSHGX3d2X3f+Z1ZSrbk2rbo6r5P+2ZgC2Zjq2tma2/7a2//+6cRm6cUi6cXG6unG6/7q6/926///Ijk3Ijm7Ijo7IyP/I///VPk/bkDrbkGbbtmbb25Db2//b/7bb///dl0jd/7rd/93d///kq27kq47k///m9Zj8jVn+4Iv/tmb/trb/unH/yI7/25D/29v/3Zf/5Kv//7b//7r//7///8j//9v//93//+T////O5LySAAAACXBIWXMAAAsSAAALEgHS3X78AAAXrUlEQVR4nO3dgZ8bx1UHcNn4aOLYSROMgNLkaIuTUqBHG6ABpynYaQsiuNAzuaSA09RcGziXuE4kEiW56K7d/5vZt5JOGs3OzG9m3rxdaX6f9O58nbt987632pU00g6qkp3MQLqAEpkA8IP+pcdlcweB56uCJ3N46TLQFPjYFHjbVliGdiMF3rYVlqHdSIG3bYVlaDdS4G1bYRnajRR421ZYhjrz6R/cr6q3//mf7laf/r763x/+9V31vS//8pX3E26DBf6tJ5984tc5yuaOFPzvPaHg7z68VT38mxeqj154+EJVPbz1eefhP1Jlv3UrR9nckYJ//q1bCv7T56uf/Mcr7799V/Xu12/c7z78p1+uK8xRNnfE4D//q/t14375yv++8Z9v3G/+CLoPX3305JNfeD9H2dwRg1e3mm/frX7y7y9UD//2+aq+2bzVB3gVdfueoWzuyMFXb/323erhl25VH31JHSk//8537vcA/uETBJ+hbO4Iwn/+l3fp7L7+rP4MVEu7D1+f1X/h/Rxlc6fcj+9cCnxsCrxtKyxDu5ECb9uK8buPbtcff/Mv+3/cfLAM7XAKvG0rpm++s0/wH79cvXObPswL6l16XLYE/NnPmj3+Vz9W9vShqp566inpdgSkwEPwi5v6n9bmP23g66H/1bdQ2dJF4MnhboVf3eP7C/+hdBVwxOH1Y7x0Q+A08BTpUpDIwp+99lg/q2fp34f2RP3uFXg2/XTVLiMIbx6auHsO8gR/AFR2wj8krPbgX85ErWkCQ1M2D1IPbSaVnQ4ksHB4E0zUmiYwNFHzAs0Dtk5lp8GIL91/K0zUmiYwNEXvYloHb5/KjmVIW7jPppioNU1gaGzzEvXOvwQqOw6BpXLH1pioNU1gaETnWNSdZVDZIT+Yo/A+w3s3j9W9vQoqO+QHM1Xdsnkmak0TGBrSuizta6uEyg74uaxVb26fiVrTBIZijcvev81SqOyAH+St0bl9JmpNExjqWXd3WkhlC5QQmh7Cf2iyz9MtSy1UtlwVYekdfFO0uPlqKVS2dCEBYbJe1wSGSvcDTV/hmag1TWCodEPw1GVL14CHy3pdExgq3RA4VLZ0EXiYqDVNYKh0Q+BQ2dJF4GGi1jSBodINgUNlSxeBh4la0wSGSjcEDpUtXQQeJmpNExgq3RA4VLZ0EXiYqDVNYKh0Q+BQ2dJF4GGi1jSBodINgUNlSxeBh4la0wSGSjcEDpUtXQQeJmpNExgq3RA4VLZ0EXiYqDVNYKh0Q+BQ2dJF4GGi1jSBodINgUNlSxeBh4la0wSGSjcEDpUtXQQeJmpNExgq3RA4VLZ0EXiYqDVNYKh0Q+BQ2dJF4GGi1jSBodINgUNlSxeBh4la0wSGSjcEDpUtXQQeJmpNExgq3RA4VLZ0EXiYqDVNYKh0Q+BQ2WPpKuAwUWuawFDphsChssfjvtEzUWuawFDphsChsse9k2ei1jSBodINgUNlj8d9o2ei1jSBodINgUNlj3snz0StaQJDpRsCh8oe906eiVrTBIZKNwQOlT3unTwTtaYJDJVuCBwqezzuGz0TtaYJDJVuCBwqe9w7eSZqTRMYKt0QOFT2uHfyTNSaJjBUuiFwqOxx7+SZqDVNYKh0Q+BQ2eNx3+iZqDVNYKh0Q+BQ2QXerAkMlW4IHCpbh+++PBO1pgkMlW4IHCp7A77z8kzUmiYwVLohcKjsWe/kmag1TWCodEPgUNmzWd/omag1TWCodEPgUNkzk7x0ZdYwUWuawFDphsChsmczE710abYwUWuawFDphsChsmczI710bZYwUWuawFDphsChsme9k2ei1jSBodINgUNlz2Yt9NLVtWbMZL2uCQyVbggcKns2a6OXLs8YVRcTtaYJDJXuCRwqe9YneSqLiVrTBIZKdwUOlT2btdNLF6hlXhUTtaYJDJXuCxwq+4PeyI+l4RcXl3y0v7//svrHH/241/Af6PRdhL8oSRW4IXJ+ZzC4NGKHv7icbPXug7O/Ww6Vbg6cFvgOyrvch1U1uXzEDX9xAWn16bO/2P/a4+b68dLdgbOA35CfdUt+jd0AP7lyoj7eG02/+PXLR8eDwbCaPnty/nr978FeQviLS8a/+4Ds/74ZKt0fOEv4bt/ar7Mb4I+Hzefp9VE1ffro9MXRHP766PzOQTr45R7/2bfp34vrx0s3CM4KvE7fHfmx7m6GPxwMDhR3NdlTXx/M4dW/F38UKeCXx/ha/NHt6uPb2wDfTfnxpnvbTf3hOnyz3yeFp7P6s9ce1+ja9eP7lXX4VnnBCk3uLSd3pzcJfn5T//SRup1PfVPfNlSwQWHR4FsP9FL1GdkN8HRDPzioT+nU7X79lfrGb/1J8pO7rYXX6IX3+XGLuwneHPpDCMwuw8vKt7EX+PhQ2R/4yGcvrXV3R+Bjsmvwbbf2mSuzuRf46FDZfvBZ5cdW99zw6mxxMLA9Hrwl8OLyDvbc8OrOoWuo9GNccKjsDXhheae7AV6/XHNS+JdcT/4MpO73BKcFXlJ+7HbPDF8duh4CGgjd7wlPG7zcCZ6Pe+49/qbzGC9x+huTZi2LCV5I3os9+x7vHtor+LrWCoRnnpyne274epe3LvIYZD77jUlTaju8hLyve2Z4epqnef7PDt8H+bETPr+8t7s//PQaPXWjPg5MT85ObM/Yrp/VW0/tB/zNSZNld23wmeXX2a3u3vC1Vv0U7Q21276OLsUM2OO7Db/aXiv8mjwzvMZud/eGn+/Rq/DqeH35aPLcNfXhmcv/NpzUR+/Tm5f+dPMeG36M77S81l4rfD55zN0b/rjhXL2pV986/2+1+06Gk72KPhwfHB+YVmvAZ/Wdlje4w/DJJ6ezu9yxPf7/jtQev3x+Vu29l0bq+9Mb6oOCHyr4e6PFn4gB/vSlNz3vx3dYfqO7Dvg88rC7/zH+xVF9hK5v6uuVeNXiz6HZ2ZfwSt3w4FzYHt9BeVNzEXgm+Q12tzt8Vq/gq8Pmtv643ncnz9QflvDqVuAZCzxwVt9BeXNzXfD88iHu0ffjtbtx1j2+fnFWHa+z+s7Bt/XWCc8tH+QeBk+neM3r6zR4tccbWMFn5zop39racPg0swtzz/rIHXpy1yF5S2vd8Jzym+x+7h19kqZr8rbOesCzyRvYw+H1X54UfrKnDga25+S7CG9vbBR83PQi3DPDn78+Ot6zLtTegJeWdzbWB55FPoY9N7w6uTscAnfnxOU9OusFb5EPnV+ce+49/vtvNi+/ROAF5X0a6wefep83sgPu2Y/xgyv/Y11pa4KXkvdrbDR8wPTM7F2Gdw81TigFY4LmtnfQDW+TR+eXwN0f3roQ4/wf1P/TvhQj6GlZYXjvvgbBh8u3oYPu3vD2hRjTfzQ9KbcJDyzEkJUH2uoLb93lvWeYyt0bvnUhRv3UTPXz0fTaJfW/lvdJC36SRkgeamsYfNgFLSzsoLs3fOtCjBr+/Icn9b8+OWnZ75E93tCRvPJoV73hHbu8c4o2ddgd2+PNCzGOD6Z/3vwZ3BmYH5VDjvHmnuSTh7saCG+cJVhWhLv/Mb5tIcawOjz4+Yjg741aXiKFnNW3NkXgVWdeXfWH95A3z9KlHuAOn9XrCzHqlRff/OEJwU8Ggz8zntqv7/G2W/o5PLg78LL7LFcNgW87qK1N1W0e5p77kTuPY3x7V2TcvTroB+8vDyYX/MpCDAze46ze1pXs6D49ReCZ5APccz9yVx8lVs4RbPBZ5SN6CsF7HeZzuOd+du5ms+qu/cR+BT7ftRujehoDn0Q+yL17b35k70v33EH49PJh7gZ4/RdLwvPLx/dUGD7QPTf8oXOxpeso2DV3FD6xfKh7ZniP5dXO859c7NDitXD4OPlg99x7/D3n251ttIZPPk1PUfiU8uHuueHdb3C42RsW+HQ9FYSPcO/iTX0O+YQtheGTyce4e8M3z8e2LMCxvg9KBd/Us8snbSkOn0o+D/yNxUfDAhxveI/3uTM2J6V86o4mgA+Tj3IPhqdXR9KSG3ofFPtDscj9eHNzNmbNyB6yhgmDTyIfgb4s2wf+Wr2nXtzU18/CDmnJDb01gjp4W94TCVmI0dKcRPAMHU0Cj8sHi6+W7QO/2OPrBTiHgys/UH8Be7Tkht4Vob5Y1Y12zcUXHk/LtrUnhTxLR0Pg4+WDwdfKRuDnt+i0uI6W3DTw0xuW8zbkadnW9mzMnYU9cA1TPDwmH6itlw3BNwtw6tvsIS25aeCre7/Tvh8H7vFp93mujgbBR8qHWW+W7QHvivWadEHH+JS7PGdHBeCDpNeiKkgDP7Fek850Vr+4uCRdOn7lSpOW/mx2ILF7UA/D4GPkg8pci8k919Oyi2vL0qXjLy4mP7A1yNAE4d19lhLekz6szGXm20/A6g9Px4PDPfp6cTVpunT8/B/19eOtDQqRZ3YPhQ+VD6xymcXmN5WME0sD36zLbuQX14+nS8dfXEx+A94pb6P3Ro/oaFJ4p3xolfNcbD4n/Px+XPNpef342v5XFvgI+RzuwfAh8sFFUta2nhP+/Psr8IvDOl063nKM95E34iPq0Ssa0sHb6MOLnGnsmW/qj+t78HSd8ovrx9Pn1rN6f3n85SeJWhoMj8pH1DjbcM8LX7/IquV1lcuh7hbhrGzuyxYGwbfKm6YYWuJKoYLwHkMl4KOaWYXDt8tvzDKsxPVKg+D1hRiLp+A/8bm4eDQ8r3xcM5ngL+YZVJ6x1CB47fn4OfzpN/LAM8rHtjIG3iGfIK1bDoenVRjHgz3zG1anhmeTj+5lp+Hbt+wNry3EmK/CUHs8Lcnwgne/cs4CzyQf38ooeF5524a94bWFGL8Y0ioMBV+/OGbPC75qLipsf7WsZ49k3Fs72El464Zh+LnbZEirMJo93pXQhRi2Hgm4WzoYDM8n79guDt884j5pVmGc39mjJRme8OhCDFuPMrvbOxhkbppVqjg36wsfFeQ9cPx7lNPd1UFUu31WaeLeamZ491D/FmVj9+ggAm2fVZJ4bDUzvNrjv2m9NK0VPqF8uiZGw6eX99loXnh1jD88sL9fPdSiDrh3EN5ro5utd48Ih6+vUHEQelZv6hGzu3cHvXrtPSt+9tzwtMcHn9WbesTpDnTQs9u+s2Jnzw2PLq/26JEwe8fg/TeZGd49FG+SrHsS+ETyyBbzwkc9ctfWJFH2DsFjW8wJ73VR4YAmJXfHOwj9hNekmN294SfNs2qH9RMy9XN0wDvZhrwVCtiklOxgAxPBR8sHle0DP6TH5/eq+Qui3YQm+Ppx+un18Adw2psks7cv+wP/lNekGN1B+OaxF3qqxuNJuU14WsQR8QCOpUkyu/sH6eCj5APL9oFvbuon9RGa4F2LL4zwSU7u2poUvbOHsHcCPrhsH/il8/EwYo+PelrW3aUY9UD3dPCh8hFle8Mf7y3gA4/x8Q/guJoUqh7Yv5TwYfIxZXvD12f19GZXgWf1HkNZm5SePSl8wKTiyvaAj8ryRZNv+r/PHUOTWNxl4SPLzgTvNZSxSxzsaeHROcWWnQk+bnl1bJOY3NPCY7OK2U5O+CpueXVUj3jQl/2J/zXLZCp9s/U/0pISPtn9eLBHjO7J4X1nFbmVvPDp7sdDPWJkZ4D3mlX0RvLCRy6vDmwSqzsDvHtWCTaRGd49NHGLuNl54B3zSrGBzPCRy6vRDvGzc8G3zivV788LH7u8GmpRHncu+JZ5Jfvt3vC0BKOiF8U3L5oOfHYubnm1d4NysTPCb04s5S/3hZ8vwXj6qDp9caT+M12hxA0fv7zaq0EZ2Tnh63BV7Q3f3D7Tc7GTIfJc/Bp8umfn1sOprvdjI6zwbPGFb5ZgzOHrN8FAbusTr7kzhcPdSX7Rn8CqBeMNX9XPxK/u8cBunwE+6aMefuK7AT9fgnFxjJ+/IzEGT4/V88Ane9QDUt9++GYJxuKs3uNdMIzwwHXnQhKrjprvBHxMGB+5W0929QLvBa9uL5xviRc7obzqBd4Hvr7rf+x6n6Qks+I9qhd4EL4+p7dcljAhvH/i0LcKniGr8LYH6qvs8PHu2wN/Vcv2widQL/Be8GkXW0YmDXuB94D3Gppp3qnYC3yf4NOpF/gewSdlL/C9gU/svhvwn5ygT8V3Db4dUJ/3PAW+oivQ9BweIff8A9hy+PM79TqMwd7kuWuXj+gyNJNnrEtpXPCLawyevbr/lQd0LXF++FB0K/+Wwx8P1X/1Hl8vw6HL0FhfAueGX7nE6KOX6Vri3PDR6mb9LYe/N6qmN5qb+uMDugxNyAqclaxeVPg2XUvcfBnxZEmkvmG/5fDLPb6Gn6/AioK/uHL42WuP6VrizVCmeaZUX9ffcng6xp/f2SN4WoCTao8/++6D+lP7ZcQThIN9gb/l8FGxHeM/+9aD+bXE+eDZ2JcN4qiaN2Lwi8uIv7O/v/+y4zLiceHb3S/6k75q7ojBtw1NPkNe9gLfUXjm3X2b4BkiBs/PXuCtmsDQlJPLwF7grZrA0HRTy7G7F3i7JjA02czysBd4qyYwNNG8crEXeKsmMDTJrDLdyhd4lyYwNMWkMrIXeKsmMDR+Sjl39wJv1wSGxk7oR5ndC7xNExgaOZ/s7gXepgkMjZmMrp6BvcBbNYGh4VPZYM/iXuBtmsDQ0IkIsRd4qyYwNGgWm+rZ3Au8TRMYik/BpJ7PvcDbNIGhpOZfv1k9o3uBt2kCQ9f47LW3oedkL/BWTWCoWVKrup08u3uBt2kCQx2mHsnKLg3v2EPaw0StaQJDe8YuA+/fjtZfwUStaQJD++aeGz64M1sNn589K3xUb7Q/ASZqTRMY2jf3XPCJ0C/CZL2uCQwNn4kIex74dNzLMFFrmsDQ0IkIsWeAT8l9ESZqTRMYGjgPMXdu+KTaK2Gi1jSBoUGzkGPnhUemuoPwGZUNobLzsHvVszvwzLCuUNn86nBd2w7PQImFymZ2Dy5uW+ET+gWHymZETzDJbYOP70iKUNls7unq3B74dD2JCpXNgs4wxf7DJ29JcKjsXqgv0lt4to4EhcpO756lbO6kg+duR0Co7MQ7e7ZXADEnBTx/JwJDZSdVz1c2dxD4LLNOGSo74b6e6U+ciVrTBIbmmXbCUNmp1DOXzZ0C77WrZz2eMVFrmsDQjHNPEyo7AbrEqnDuFHiXef6TVyZqTRMYmrsB0aGyw8FF1K8W+PhQ2VZWV+TK5k6B75j61QIfHyq7Z+pXC3x8qOx+oS/L5k6B75j61QIfHyq7V+YUJmpNExgq3RA4VHavzClM1JomMFS6IXCo7D6RN2Gi1jSBodINgUNl90BaCxO1pgkMlW4IHCpbugg8TNSaJjBUuiFwqGzpIvAwUWuawFDphsChsqWLwMNErWkavre4uCR9XrnSpHRD4BR4DH5xbVn6vPhHgc8WMfjF1aTp8/wf9fXjHXEOiP0BfAM0Q/ky0PFS8Ivrx9Pni4vJuwLXi/4A0wY6UkbEBkLiu8d7pHsNKfDtAY7xJdsU2/XjtbP6km0KcD++ZJtS4Hc0qeDhI4L6ga89BsafvQpu4NHt+me+8sBZBvRr0bLhuv3Kjk8qeHUOqO74AVETfIScNKrBHyPj39mnDTxy3CNB60bLRuv2LDs+6W7qf/Ov0F/pu9/Ddp26gcCuc/azxsfddKxutGywbv+yY5MM/uxV7JZY3Uf0fHxg8fv3v/ptZAPUQXXfxPl7obrRsuG6PcuOTsKTO6wh7z4AfwDdQN3Bs+967M3Qrw0oG/sB77Ijkwr+EbonoMdsNR57IEn9wGffcjYQrRstG67br+z4JDyrx4596A/Adxvqju/v7ztUA8qA54me1XuUHZ9yP35HU+B3NAV+R1PgdzQFfkdT4Hc0Ww5/+o2T6bMn0lV0MVsOr9QLvDFbBD/94tcHv3tnMKyOB+rD9Lmbg73zO4Mr76lv7y2G1N8ULLFD2Sb466P6v2ffe/ro9MXRVH186aje46+P1BfzIfRN2TI7km2Cp5v16bO/2KuqwwP15fnro+Z76ovlkOXXO54Cv6PZQvj5TX2Bt2YL4U/Uyd3B3Pj05pX3CrwpWwRfgmRH4KfX6lcjXio7+zI7Al+ip8DvaAr8jqbA72gK/I7m/wEZErlYE4W66QAAAABJRU5ErkJggg==" alt="plot of chunk unnamed-chunk-5"/></p>

<p>Estimates of stock-specific abundance can be used with the same inputs and <code>plot_ribbon_abund()</code>.</p>

<pre><code class="r">plot_ribbon_abund(x_var = &quot;month_n&quot;, grouping_var = &quot;agg&quot;, 
                 colour_var = &quot;region&quot;, ssdr = m1$ssdr, comp_dat = comp_ex,
                 pred_dat = new_dat)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-6"/></p>

</body>

</html>
